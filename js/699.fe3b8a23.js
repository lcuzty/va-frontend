"use strict";(self["webpackChunkvolunteer_aid"]=self["webpackChunkvolunteer_aid"]||[]).push([[699],{4145:function(a,t,e){e.r(t),e.d(t,{default:function(){return _}});var l=e(6252),o=e(3577);const i={style:{width:"90%",height:"100vh",padding:"40px 0px",color:"var(--color-neutral-10)","max-width":"1550px",margin:"0 auto"}},d=(0,l._)("p",{style:{"font-size":"24px","font-weight":"bold","margin-bottom":"20px"}},"学校开设专业信息管理",-1),n={style:{width:"100%",height:"calc(100% - 64px)",position:"relative"}},r={style:{width:"calc(100%)",height:"100%",display:"inline-block","overflow-y":"auto"}},s={style:{"margin-bottom":"20px",width:"100%",position:"relative"}},g={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)","max-width":"300px"}},p=(0,l._)("p",{style:{color:"var(--color-neutral-10)"}},"请导入包含学校开设专业介绍信息的JSON字符串的文本文件。",-1),c={key:0,style:{display:"inline-block",float:"right"}},m={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)"}},h=(0,l._)("br",null,null,-1),f={key:0,style:{color:"red"}},u={style:{"max-height":"calc(80vh - 48px - 65px)","overflow-y":"scroll"}};function b(a,t,e,b,x,S){const k=(0,l.up)("a-option"),v=(0,l.up)("a-select"),w=(0,l.up)("a-input"),y=(0,l.up)("v-btn"),I=(0,l.up)("a-upload"),C=(0,l.up)("a-trigger"),T=(0,l.up)("a-button"),_=(0,l.up)("a-table"),U=(0,l.up)("data-editor"),W=(0,l.up)("a-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",i,[d,(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("div",s,[(0,l.Wm)(v,{disabled:x.data.loading,onChange:S.getTable,style:{width:"80px","line-height":"36px",height:"36px","margin-right":"10px"},modelValue:x.data.form.level,"onUpdate:modelValue":t[0]||(t[0]=a=>x.data.form.level=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Uk)("本科")])),_:1}),(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Uk)("专科")])),_:1})])),_:1},8,["disabled","onChange","modelValue"]),(0,l.Wm)(w,{disabled:x.data.loading,modelValue:x.data.form.universityName,"onUpdate:modelValue":t[1]||(t[1]=a=>x.data.form.universityName=a),style:{border:"0px","line-height":"36px",display:"inline-block",width:"200px","margin-right":"10px","background-color":"transparent","border-bottom":"1px solid var(--color-neutral-10)"},placeholder:"学校名称"},null,8,["disabled","modelValue"]),(0,l.Wm)(y,{loading:x.data.loading,style:{"margin-right":"10px"},variant:"text",onClick:S.getTable},{default:(0,l.w5)((()=>[(0,l.Uk)("搜索/刷新")])),_:1},8,["loading","onClick"]),(0,l.Wm)(C,{trigger:"click","unmount-on-close":!1},{content:(0,l.w5)((()=>[(0,l._)("div",g,[p,(0,l.Wm)(I,{onSuccess:S.imported,action:e.appData.serverURL+"/bg/schoolSpecial/import"},null,8,["onSuccess","action"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{disabled:x.data.loading,style:{"margin-right":"10px"},variant:"text"},{default:(0,l.w5)((()=>[(0,l.Uk)("导入")])),_:1},8,["disabled"])])),_:1}),(0,l.Wm)(y,{disabled:x.data.loading||0==x.data.form.total,style:{"margin-right":"0px"},variant:"text",onClick:S.deleteAll},{default:(0,l.w5)((()=>[(0,l.Uk)("清空")])),_:1},8,["disabled","onClick"]),x.data.form.total>x.data.form.size?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(y,{variant:"text",onClick:t[2]||(t[2]=a=>{x.data.form.page=1,S.getTable()}),disabled:x.data.loading||1==x.data.form.page,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("第一页")])),_:1},8,["disabled"]),(0,l.Wm)(y,{variant:"text",onClick:t[3]||(t[3]=a=>{x.data.form.page-=1,S.getTable()}),disabled:x.data.loading||1==x.data.form.page,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("上一页")])),_:1},8,["disabled"]),(0,l.Wm)(C,{trigger:"click","unmount-on-close":!1},{content:(0,l.w5)((()=>[(0,l._)("div",m,[(0,l.Wm)(w,{modelValue:x.data.form.pageInput,"onUpdate:modelValue":t[4]||(t[4]=a=>x.data.form.pageInput=a),placeholder:"页码",style:{width:"70px"}},null,8,["modelValue"]),(0,l.Wm)(T,{loading:x.data.loading,onClick:S.tableChangePage,disabled:""==x.data.form.pageInput,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("转到")])),_:1},8,["loading","onClick","disabled"]),h,""!=x.data.form.warningText?((0,l.wg)(),(0,l.iD)("p",f,(0,o.zw)(x.data.form.warningText),1)):(0,l.kq)("",!0)])])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{variant:"text",disabled:x.data.loading,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(x.data.form.page.toString()+"/"+x.data.form.pageTotal.toString()),1)])),_:1},8,["disabled"])])),_:1}),(0,l.Wm)(y,{variant:"text",onClick:t[5]||(t[5]=a=>{x.data.form.page+=1,S.getTable()}),disabled:x.data.loading||x.data.form.page==x.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("下一页")])),_:1},8,["disabled"]),(0,l.Wm)(y,{variant:"text",onClick:t[6]||(t[6]=a=>{x.data.form.page=x.data.form.pageTotal,S.getTable()}),disabled:x.data.loading||x.data.form.page==x.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("最后一页")])),_:1},8,["disabled"])])):(0,l.kq)("",!0)]),(0,l.Wm)(_,{onRowClick:S.tableRowClick,pagination:!1,loading:x.data.loading,style:{width:"100%"},columns:[{dataIndex:"mark",title:"标记"},{dataIndex:"universityName",title:"学校名称"},{dataIndex:"majorName",title:"专业名称"},{dataIndex:"level",title:"等级"},{dataIndex:"className",title:"类名"},{dataIndex:"bigClassName",title:"大类名"}],data:x.data.table},null,8,["onRowClick","loading","data"])])])]),(0,l.Wm)(W,{visible:x.data.showEditSchoolSpecialInfoForm,"onUpdate:visible":t[7]||(t[7]=a=>x.data.showEditSchoolSpecialInfoForm=a),onOk:S.changeSchoolSpecialInfo,closable:0==x.data.isSaving,"mask-closable":0==x.data.isSaving,"ok-loading":x.data.isSaving},{title:(0,l.w5)((()=>[(0,l.Uk)(" 编辑学校开设专业信息 ")])),default:(0,l.w5)((()=>[(0,l._)("div",u,[x.data.showEditSchoolSpecialInfoForm?((0,l.wg)(),(0,l.j4)(U,{key:0,"read-only":1==x.data.isSaving,onDataChanged:S.SchoolSpecialInfoChanged,style:{color:"var(--color-neutral-10)",width:"100%","background-color":"white","border-radius":"5px",padding:"15px 15px 5px 15px"},data:x.data.editSchoolSpecialInfoSelectedItem},null,8,["read-only","onDataChanged","data"])):(0,l.kq)("",!0)])])),_:1},8,["visible","onOk","closable","mask-closable","ok-loading"])],64)}var x=e(2487),S=e.n(x),k=e(9182),v=e.n(k),w=e(6207),y=e(5121),I={components:{dataEditor:w.Z},name:"",data(){return{data:{loading:!1,form:{page:1,size:25,total:0,pageTotal:0,pageInput:"",warningText:"",universityName:"",level:"本科"},table:[],showEditSchoolSpecialInfoForm:!1,editSchoolSpecialInfoSelectedItem:void 0,editSchoolSpecialInfoSelectedItemMark:void 0,isSaving:!1}}},methods:{async changeSchoolSpecialInfo(){this.data.isSaving=!0,this.data.editSchoolSpecialInfoSelectedItem["mark"]=this.data.editSchoolSpecialInfoSelectedItemMark.toString();const a=S().encodeString(JSON.stringify({token:this.bgData.loginedAdminInfo.token,item:this.data.editSchoolSpecialInfoSelectedItem})),t=new Blob([a],{type:"text/plain"}),e=new FormData;e.append("file",t,"filename.txt"),await y.Z.post(v().serverURL+"/bg/schoolSpecial/change",e,{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{console.log(a)})),this.data.isSaving=!1,this.getTable()},SchoolSpecialInfoChanged(a){this.data.editSchoolSpecialInfoSelectedItem=JSON.parse(JSON.stringify(a)).data},tableRowClick(a){for(let e=0;e<Object.keys(a).length;e++)try{a[Object.keys(a)[e]]=JSON.parse(a[Object.keys(a)[e]])}catch(t){}a=JSON.parse(JSON.stringify(a)),this.data.editSchoolSpecialInfoSelectedItemMark=a.mark,delete a["mark"],this.data.editSchoolSpecialInfoSelectedItem=a,this.data.showEditSchoolSpecialInfoForm=!0},async deleteAll(){this.data.loading=!0,await S().axiosPostWithCheckStatus(v().serverURL,"/bg/schoolSpecial/delete",{token:this.bgData.loginedAdminInfo.token}),this.data.loading=!1,this.data.form.page=1,this.getTable()},tableChangePage(){this.data.form.warningText="";let a=parseInt(this.data.form.pageInput);isNaN(a)?this.data.form.warningText="页码应为数字":a<1||a>this.data.form.pageTotal?this.data.form.warningText="页码应在1到"+this.data.form.pageTotal.toString()+"之间":(this.data.form.page=a,this.getTable())},imported(){this.getTable()},async getTable(){this.data.loading=!0;let a=await S().axiosPostWithCheckStatus(v().serverURL,"/bg/schoolSpecial/list",{token:this.bgData.loginedAdminInfo.token,page:this.data.form.page,size:this.data.form.size,universityName:this.data.form.universityName,level:this.data.form.level});console.log(a),this.data.form.total=a.results.total,this.data.form.pageTotal=S().getPageTotal(a.results.total,this.data.form.size),this.data.table=a.results.data,this.data.loading=!1}},mounted(){this.getTable()},props:{appData:void 0,bgData:void 0},computed:{},watch:{},created(){},beforeMount(){},beforeUpdate(){},beforeDestroy(){},updated(){},destroyed(){},activated(){}},C=e(3744);const T=(0,C.Z)(I,[["render",b]]);var _=T}}]);
//# sourceMappingURL=699.fe3b8a23.js.map