"use strict";(self["webpackChunkvolunteer_aid"]=self["webpackChunkvolunteer_aid"]||[]).push([[55],{875:function(a,t,e){e.r(t),e.d(t,{default:function(){return C}});var o=e(6252),d=e(3577);const i={style:{width:"100%",height:"100vh",color:"var(--color-neutral-10)",margin:"0 auto"}},l=(0,o._)("div",{style:{padding:"40px 0 0 0",margin:"0 auto","max-width":"1550px",width:"90%"}},[(0,o._)("p",{style:{"font-size":"24px","font-weight":"bold","margin-bottom":"20px"}},"学校信息管理")],-1),n={style:{width:"100%",height:"calc(100% - 96px)",position:"relative","overflow-y":"auto"}},r={style:{width:"90%",height:"100%",margin:"0 auto","max-width":"1550px"}},s={style:{"margin-bottom":"20px",width:"100%",position:"relative"}},g={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)","max-width":"300px"}},m=(0,o._)("p",{style:{color:"var(--color-neutral-10)"}},"选择的表格文件的第一张工作表应包含导入数据，并且工作表从A1单元格到AN1单元格的内容应依次为：学校名称、省份、城市、等级、是否为985、是否为211、是否为双一流、是否为强基、区名、类别、性质、建校日期、面积、旧名、简 称、主管部门、国家重点学科、一级硕士点数量、二级硕士点数量、一级博士点数量、二级博士点数量、校友会排名、US世界排名、科研项目数量、软科排名、邮箱、地址、学校网址、电话、简介、双一流学科、专业数量、国家特色专业、各省最低分、宿舍介绍、食堂介绍、毕业生去向落实率、毕业生签约地区流向、毕业生签约单位性质、主要签约单位。",-1),p={key:0,style:{display:"inline-block",float:"right"}},c={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)"}},h=(0,o._)("br",null,null,-1),f={key:0,style:{color:"red"}},u={style:{"max-height":"calc(80vh - 48px - 65px)","overflow-y":"scroll"}};function b(a,t,e,b,x,k){const w=(0,o.up)("a-input"),v=(0,o.up)("v-btn"),y=(0,o.up)("a-upload"),I=(0,o.up)("a-trigger"),S=(0,o.up)("a-button"),_=(0,o.up)("a-table"),T=(0,o.up)("data-editor"),C=(0,o.up)("a-modal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",i,[l,(0,o._)("div",n,[(0,o._)("div",r,[(0,o._)("div",s,[(0,o.Wm)(w,{disabled:x.data.loading,modelValue:x.data.form.universityName,"onUpdate:modelValue":t[0]||(t[0]=a=>x.data.form.universityName=a),style:{border:"0px","line-height":"36px",display:"inline-block",width:"200px","margin-right":"10px","background-color":"transparent","border-bottom":"1px solid var(--color-neutral-10)"},placeholder:"学校名称"},null,8,["disabled","modelValue"]),(0,o.Wm)(v,{loading:x.data.loading,style:{"margin-right":"10px"},variant:"text",onClick:t[1]||(t[1]=a=>{x.data.form.page=1,k.getTable()})},{default:(0,o.w5)((()=>[(0,o.Uk)("搜索/刷新")])),_:1},8,["loading"]),(0,o.Wm)(I,{trigger:"click","unmount-on-close":!1},{content:(0,o.w5)((()=>[(0,o._)("div",g,[m,(0,o.Wm)(y,{onSuccess:k.imported,action:e.appData.serverURL+"/bg/school/import"},null,8,["onSuccess","action"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(v,{disabled:x.data.loading,style:{"margin-right":"10px"},variant:"text"},{default:(0,o.w5)((()=>[(0,o.Uk)("导入")])),_:1},8,["disabled"])])),_:1}),(0,o.Wm)(v,{disabled:x.data.loading||0==x.data.form.total,style:{"margin-right":"0px"},variant:"text",onClick:k.deleteAll},{default:(0,o.w5)((()=>[(0,o.Uk)("清空")])),_:1},8,["disabled","onClick"]),x.data.form.total>x.data.form.size?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(v,{variant:"text",onClick:t[2]||(t[2]=a=>{x.data.form.page=1,k.getTable()}),disabled:x.data.loading||1==x.data.form.page,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("第一页")])),_:1},8,["disabled"]),(0,o.Wm)(v,{variant:"text",onClick:t[3]||(t[3]=a=>{x.data.form.page-=1,k.getTable()}),disabled:x.data.loading||1==x.data.form.page,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("上一页")])),_:1},8,["disabled"]),(0,o.Wm)(I,{trigger:"click","unmount-on-close":!1},{content:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o.Wm)(w,{modelValue:x.data.form.pageInput,"onUpdate:modelValue":t[4]||(t[4]=a=>x.data.form.pageInput=a),placeholder:"页码",style:{width:"70px"}},null,8,["modelValue"]),(0,o.Wm)(S,{loading:x.data.loading,onClick:k.tableChangePage,disabled:""==x.data.form.pageInput,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("转到")])),_:1},8,["loading","onClick","disabled"]),h,""!=x.data.form.warningText?((0,o.wg)(),(0,o.iD)("p",f,(0,d.zw)(x.data.form.warningText),1)):(0,o.kq)("",!0)])])),default:(0,o.w5)((()=>[(0,o.Wm)(v,{variant:"text",disabled:x.data.loading,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,d.zw)(x.data.form.page.toString()+"/"+x.data.form.pageTotal.toString()),1)])),_:1},8,["disabled"])])),_:1}),(0,o.Wm)(v,{variant:"text",onClick:t[5]||(t[5]=a=>{x.data.form.page+=1,k.getTable()}),disabled:x.data.loading||x.data.form.page==x.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("下一页")])),_:1},8,["disabled"]),(0,o.Wm)(v,{variant:"text",onClick:t[6]||(t[6]=a=>{x.data.form.page=x.data.form.pageTotal,k.getTable()}),disabled:x.data.loading||x.data.form.page==x.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("最后一页")])),_:1},8,["disabled"])])):(0,o.kq)("",!0)]),(0,o.Wm)(_,{onRowClick:k.tableRowClick,pagination:!1,loading:x.data.loading,style:{width:"100%","margin-bottom":"40px"},columns:[{dataIndex:"mark",title:"标记"},{dataIndex:"universityName",title:"学校名称"},{dataIndex:"p",title:"省份"},{dataIndex:"city",title:"城市"},{dataIndex:"town_name",title:"区名"},{dataIndex:"level",title:"等级"},{dataIndex:"is985",title:"是否为985"},{dataIndex:"is211",title:"是否为211"},{dataIndex:"isDualClass",title:"是否为双一流"},{dataIndex:"isQJ",title:"是否为强基"},{dataIndex:"type_name",title:"类别"},{dataIndex:"school_nature_name",title:"性质"},{dataIndex:"create_date",title:"建校日期"},{dataIndex:"belong",title:"主管部门"}],data:x.data.table},null,8,["onRowClick","loading","data"])])])]),(0,o.Wm)(C,{visible:x.data.showEditSchoolInfoForm,"onUpdate:visible":t[7]||(t[7]=a=>x.data.showEditSchoolInfoForm=a),onOk:k.changeSchoolInfo,closable:0==x.data.isSaving,"mask-closable":0==x.data.isSaving,"ok-loading":x.data.isSaving},{title:(0,o.w5)((()=>[(0,o.Uk)(" 编辑学校信息 ")])),default:(0,o.w5)((()=>[(0,o._)("div",u,[x.data.showEditSchoolInfoForm?((0,o.wg)(),(0,o.j4)(T,{key:0,"read-only":1==x.data.isSaving,onDataChanged:k.schoolInfoChanged,style:{color:"var(--color-neutral-10)",width:"100%","background-color":"white","border-radius":"5px",padding:"15px 15px 5px 15px"},data:x.data.editSchoolInfoSelectedItem},null,8,["read-only","onDataChanged","data"])):(0,o.kq)("",!0)])])),_:1},8,["visible","onOk","closable","mask-closable","ok-loading"])],64)}var x=e(2487),k=e.n(x),w=e(9182),v=e.n(w),y=e(6207),I=e(5121),S={components:{dataEditor:y.Z},name:"",data(){return{data:{loading:!1,form:{page:1,size:25,total:0,pageTotal:0,pageInput:"",warningText:"",universityName:""},table:[],showEditSchoolInfoForm:!1,editSchoolInfoSelectedItem:void 0,editSchoolInfoSelectedItemMark:void 0,isSaving:!1}}},methods:{async changeSchoolInfo(){this.data.isSaving=!0,this.data.editSchoolInfoSelectedItem["mark"]=this.data.editSchoolInfoSelectedItemMark.toString();const a=k().encodeString(JSON.stringify({token:this.bgData.loginedAdminInfo.token,data:this.data.editSchoolInfoSelectedItem})),t=new Blob([a],{type:"text/plain"}),e=new FormData;e.append("file",t,"filename.txt"),await I.Z.post(v().serverURL+"/bg/school/change",e,{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{console.log(a)})),this.data.isSaving=!1,this.getTable()},schoolInfoChanged(a){this.data.editSchoolInfoSelectedItem=JSON.parse(JSON.stringify(a)).data},tableRowClick(a){for(let e=0;e<Object.keys(a).length;e++)try{a[Object.keys(a)[e]]=JSON.parse(a[Object.keys(a)[e]])}catch(t){}a=JSON.parse(JSON.stringify(a)),this.data.editSchoolInfoSelectedItemMark=a.mark,delete a["mark"],this.data.editSchoolInfoSelectedItem=a,this.data.showEditSchoolInfoForm=!0},async deleteAll(){this.data.loading=!0,await k().axiosPostWithCheckStatus(v().serverURL,"/bg/school/delete",{token:this.bgData.loginedAdminInfo.token}),this.data.loading=!1,this.data.form.page=1,this.getTable()},tableChangePage(){this.data.form.warningText="";let a=parseInt(this.data.form.pageInput);isNaN(a)?this.data.form.warningText="页码应为数字":a<1||a>this.data.form.pageTotal?this.data.form.warningText="页码应在1到"+this.data.form.pageTotal.toString()+"之间":(this.data.form.page=a,this.getTable())},imported(){this.getTable()},async getTable(){this.data.loading=!0;let a=await k().axiosPostWithCheckStatus(v().serverURL,"/bg/school/list",{token:this.bgData.loginedAdminInfo.token,page:this.data.form.page,size:this.data.form.size,universityName:this.data.form.universityName});this.data.form.total=a.results.total,this.data.form.pageTotal=k().getPageTotal(a.results.total,this.data.form.size),this.data.table=a.results.data,this.data.loading=!1}},mounted(){this.getTable()},props:{appData:void 0,bgData:void 0},computed:{},watch:{},created(){},beforeMount(){},beforeUpdate(){},beforeDestroy(){},updated(){},destroyed(){},activated(){}},_=e(3744);const T=(0,_.Z)(S,[["render",b]]);var C=T}}]);
//# sourceMappingURL=55.588a7ae1.js.map