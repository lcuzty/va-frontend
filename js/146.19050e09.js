"use strict";(self["webpackChunkvolunteer_aid"]=self["webpackChunkvolunteer_aid"]||[]).push([[146],{8542:function(a,t,e){e.r(t),e.d(t,{default:function(){return _}});var d=e(6252),o=e(3577);const i={style:{width:"90%",height:"100vh",padding:"40px 0px",color:"var(--color-neutral-10)","max-width":"1550px",margin:"0 auto"}},l=(0,d._)("p",{style:{"font-size":"24px","font-weight":"bold","margin-bottom":"20px"}},"收费管理",-1),n={style:{width:"100%",height:"calc(100% - 64px)",position:"relative"}},r={style:{width:"calc(100%)",height:"100%",display:"inline-block","overflow-y":"auto"}},s={style:{"margin-bottom":"20px",width:"100%",position:"relative"}},g={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)","max-width":"300px"}},c=(0,d._)("p",{style:{color:"var(--color-neutral-10)"}},"请导入Excel文件，表格第一行标题应依次为序列号、类型和有效年份。",-1),p={key:0,style:{display:"inline-block",float:"right"}},m={style:{padding:"20px 20px","border-radius":"10px","background-color":"var(--color-neutral-1)","box-shadow":"0 4px 10px rgba(0,0,0,0.1)"}},f=(0,d._)("br",null,null,-1),h={key:0,style:{color:"red"}},u={style:{"max-height":"calc(80vh - 48px - 65px)","overflow-y":"scroll"}};function b(a,t,e,b,k,x){const w=(0,d.up)("a-input"),y=(0,d.up)("v-btn"),v=(0,d.up)("a-upload"),I=(0,d.up)("a-trigger"),S=(0,d.up)("a-button"),T=(0,d.up)("a-table"),C=(0,d.up)("data-editor"),_=(0,d.up)("a-modal");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",i,[l,(0,d._)("div",n,[(0,d._)("div",r,[(0,d._)("div",s,[(0,d.Wm)(w,{disabled:k.data.loading,modelValue:k.data.form.key,"onUpdate:modelValue":t[0]||(t[0]=a=>k.data.form.key=a),style:{border:"0px","line-height":"36px",display:"inline-block",width:"200px","margin-right":"10px","background-color":"transparent","border-bottom":"1px solid var(--color-neutral-10)"},placeholder:"序列号"},null,8,["disabled","modelValue"]),(0,d.Wm)(y,{loading:k.data.loading,style:{"margin-right":"10px"},variant:"text",onClick:x.getTable},{default:(0,d.w5)((()=>[(0,d.Uk)("搜索/刷新")])),_:1},8,["loading","onClick"]),(0,d.Wm)(I,{trigger:"click","unmount-on-close":!1},{content:(0,d.w5)((()=>[(0,d._)("div",g,[c,(0,d.Wm)(v,{onSuccess:x.imported,action:e.appData.serverURL+"/bg/card/import"},null,8,["onSuccess","action"])])])),default:(0,d.w5)((()=>[(0,d.Wm)(y,{disabled:k.data.loading,style:{"margin-right":"10px"},variant:"text"},{default:(0,d.w5)((()=>[(0,d.Uk)("导入")])),_:1},8,["disabled"])])),_:1}),k.data.form.total>k.data.form.size?((0,d.wg)(),(0,d.iD)("div",p,[(0,d.Wm)(y,{variant:"text",onClick:t[1]||(t[1]=a=>{k.data.form.page=1,x.getTable()}),disabled:k.data.loading||1==k.data.form.page,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("第一页")])),_:1},8,["disabled"]),(0,d.Wm)(y,{variant:"text",onClick:t[2]||(t[2]=a=>{k.data.form.page-=1,x.getTable()}),disabled:k.data.loading||1==k.data.form.page,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("上一页")])),_:1},8,["disabled"]),(0,d.Wm)(I,{trigger:"click","unmount-on-close":!1},{content:(0,d.w5)((()=>[(0,d._)("div",m,[(0,d.Wm)(w,{modelValue:k.data.form.pageInput,"onUpdate:modelValue":t[3]||(t[3]=a=>k.data.form.pageInput=a),placeholder:"页码",style:{width:"70px"}},null,8,["modelValue"]),(0,d.Wm)(S,{loading:k.data.loading,onClick:x.tableChangePage,disabled:""==k.data.form.pageInput,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("转到")])),_:1},8,["loading","onClick","disabled"]),f,""!=k.data.form.warningText?((0,d.wg)(),(0,d.iD)("p",h,(0,o.zw)(k.data.form.warningText),1)):(0,d.kq)("",!0)])])),default:(0,d.w5)((()=>[(0,d.Wm)(y,{variant:"text",disabled:k.data.loading,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)((0,o.zw)(k.data.form.page.toString()+"/"+k.data.form.pageTotal.toString()),1)])),_:1},8,["disabled"])])),_:1}),(0,d.Wm)(y,{variant:"text",onClick:t[4]||(t[4]=a=>{k.data.form.page+=1,x.getTable()}),disabled:k.data.loading||k.data.form.page==k.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("下一页")])),_:1},8,["disabled"]),(0,d.Wm)(y,{variant:"text",onClick:t[5]||(t[5]=a=>{k.data.form.page=k.data.form.pageTotal,x.getTable()}),disabled:k.data.loading||k.data.form.page==k.data.form.pageTotal,style:{"margin-left":"5px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("最后一页")])),_:1},8,["disabled"])])):(0,d.kq)("",!0)]),(0,d.Wm)(T,{onRowClick:x.tableRowClick,pagination:!1,loading:k.data.loading,style:{width:"100%"},columns:[{dataIndex:"mark",title:"标记"},{dataIndex:"key",title:"序列号"},{dataIndex:"type",title:"类型"},{dataIndex:"userMark",title:"用户mark"},{dataIndex:"year",title:"有效年份"}],data:k.data.table},null,8,["onRowClick","loading","data"])])])]),(0,d.Wm)(_,{visible:k.data.showEditcardInfoForm,"onUpdate:visible":t[6]||(t[6]=a=>k.data.showEditcardInfoForm=a),onOk:x.changecardInfo,closable:0==k.data.isSaving,"mask-closable":0==k.data.isSaving,"ok-loading":k.data.isSaving},{title:(0,d.w5)((()=>[(0,d.Uk)(" 编辑卡信息 ")])),default:(0,d.w5)((()=>[(0,d._)("div",u,[(0,d.Wm)(y,{onClick:x.deleteSingle,variant:"text",style:{"margin-bottom":"10px"}},{default:(0,d.w5)((()=>[(0,d.Uk)("删除")])),_:1},8,["onClick"]),k.data.showEditcardInfoForm?((0,d.wg)(),(0,d.j4)(C,{key:0,"read-only":1==k.data.isSaving,onDataChanged:x.cardInfoChanged,style:{color:"var(--color-neutral-10)",width:"100%","background-color":"white","border-radius":"5px",padding:"15px 15px 5px 15px"},data:k.data.editcardInfoSelectedItem},null,8,["read-only","onDataChanged","data"])):(0,d.kq)("",!0)])])),_:1},8,["visible","onOk","closable","mask-closable","ok-loading"])],64)}var k=e(2487),x=e.n(k),w=e(9182),y=e.n(w),v=e(6207),I=e(5121),S={components:{dataEditor:v.Z},name:"",data(){return{data:{loading:!1,form:{page:1,size:25,total:0,pageTotal:0,pageInput:"",warningText:"",key:""},table:[],showEditcardInfoForm:!1,editcardInfoSelectedItem:void 0,editcardInfoSelectedItemMark:void 0,isSaving:!1}}},methods:{async changecardInfo(){this.data.isSaving=!0,this.data.editcardInfoSelectedItem["mark"]=this.data.editcardInfoSelectedItemMark.toString();const a=x().encodeString(JSON.stringify({token:this.bgData.loginedAdminInfo.token,item:this.data.editcardInfoSelectedItem})),t=new Blob([a],{type:"text/plain"}),e=new FormData;e.append("file",t,"filename.txt"),await I.Z.post(y().serverURL+"/bg/card/change",e,{headers:{"Content-Type":"multipart/form-data"}}).then((a=>{console.log(a)})),this.data.isSaving=!1,this.getTable()},cardInfoChanged(a){this.data.editcardInfoSelectedItem=JSON.parse(JSON.stringify(a)).data},tableRowClick(a){for(let e=0;e<Object.keys(a).length;e++)try{a[Object.keys(a)[e]]=JSON.parse(a[Object.keys(a)[e]])}catch(t){}a=JSON.parse(JSON.stringify(a)),this.data.editcardInfoSelectedItemMark=a.mark,delete a["mark"],this.data.editcardInfoSelectedItem=a,this.data.showEditcardInfoForm=!0},async deleteSingle(){this.data.loading=!0,await x().axiosPostWithCheckStatus(y().serverURL,"/bg/card/deleteSingle",{token:this.bgData.loginedAdminInfo.token,mark:this.data.editcardInfoSelectedItemMark}),this.data.loading=!1,this.data.form.page=1,this.data.showEditcardInfoForm=!1,this.getTable()},tableChangePage(){this.data.form.warningText="";let a=parseInt(this.data.form.pageInput);isNaN(a)?this.data.form.warningText="页码应为数字":a<1||a>this.data.form.pageTotal?this.data.form.warningText="页码应在1到"+this.data.form.pageTotal.toString()+"之间":(this.data.form.page=a,this.getTable())},imported(){this.getTable()},async getTable(){this.data.loading=!0;let a=await x().axiosPostWithCheckStatus(y().serverURL,"/bg/card/list",{token:this.bgData.loginedAdminInfo.token,page:this.data.form.page,size:this.data.form.size,key:this.data.form.key,level:this.data.form.level});console.log(a),this.data.form.total=a.results.total,this.data.form.pageTotal=x().getPageTotal(a.results.total,this.data.form.size),this.data.table=a.results.data,this.data.loading=!1}},mounted(){this.getTable()},props:{appData:void 0,bgData:void 0},computed:{},watch:{},created(){},beforeMount(){},beforeUpdate(){},beforeDestroy(){},updated(){},destroyed(){},activated(){}},T=e(3744);const C=(0,T.Z)(S,[["render",b]]);var _=C}}]);
//# sourceMappingURL=146.19050e09.js.map